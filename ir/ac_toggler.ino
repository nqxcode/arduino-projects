#include <Wire.h>
#include <SPI.h>
#include <Adafruit_BME280.h>
#include <IRremote.h>
#include <avr/pgmspace.h>

#define minTemperature 25.65 // case when AC turn off
#define maxTemperature 25.95 // Thermal stress, AC turn on

bool AC_ON = false;
bool AC_OFF = false;

int modeAnalogPin = 3;

Adafruit_BME280 bme;

IRsend irsend;
int khz = 38;

// Signals correspond to temperatures range from  24 °C to  19 °C
const unsigned int Signals_TURN_ON[6][439] PROGMEM = {
  {3548, 1688, 440, 432, 440, 1304, 492, 380, 492, 380, 440, 432, 440, 432, 492, 380, 440, 428, 496, 380, 440, 428, 444, 428, 444, 428, 492, 380, 492, 1252, 496, 376, 444, 428, 444, 428, 496, 376, 496, 376, 496, 376, 440, 432, 440, 1304, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 1304, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 492, 380, 440, 432, 440, 428, 444, 432, 440, 432, 492, 380, 440, 432, 440, 428, 444, 428, 496, 376, 492, 380, 440, 432, 496, 376, 496, 376, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 1304, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 10020, 3496, 1736, 444, 428, 492, 1252, 440, 432, 496, 376, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 432, 440, 432, 492, 380, 440, 432, 440, 432, 492, 380, 492, 380, 492, 1252, 440, 1304, 492, 1252, 492, 380, 440, 432, 444, 1300, 440, 428, 448, 424, 496, 376, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 496, 380, 488, 380, 440, 432, 440, 1304, 440, 432, 440, 432, 492, 1252, 440, 1304, 440, 1304, 492, 380, 440, 432, 492, 380, 440, 432, 492, 380, 492, 380, 492, 1252, 440, 1304, 440, 432, 440, 432, 440, 432, 440, 428, 444, 432, 440, 428, 496, 376, 444, 428, 444, 428, 444, 1300, 440, 1308, 436, 432, 440, 432, 492, 380, 492, 1252, 492, 1252, 492, 1252, 492, 380, 440, 432, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 440, 428, 444, 1300, 444, 1304, 440, 1300, 500, 376, 436, 432, 440, 432, 440, 432, 440, 432, 496, 376, 440, 432, 440, 432, 448, 424, 440, 1304, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 492, 380, 440, 432, 492, 380, 440, 432, 492, 380, 440, 428, 444, 428, 444, 432, 440, 428, 444, 1300, 444, 432, 440, 428, 444, 428, 444, 428, 496, 376, 496, 376, 444, 1300, 440, 432, 496, 376, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 492, 1252, 440, 432, 440, 1304, 440, 432, 440, 1304, 440, 432, 440, 1300, 444, 1300, 444},
  {3496, 1736, 440, 432, 440, 1332, 412, 432, 440, 460, 412, 432, 440, 460, 412, 460, 412, 432, 440, 432, 440, 432, 440, 456, 416, 456, 416, 456, 416, 1328, 416, 456, 416, 432, 440, 428, 444, 428, 444, 456, 416, 428, 444, 428, 440, 1308, 440, 1328, 412, 1304, 440, 460, 416, 428, 440, 1332, 412, 460, 412, 456, 416, 460, 412, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 456, 416, 432, 440, 432, 440, 428, 444, 456, 416, 456, 416, 428, 444, 432, 440, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 444, 428, 444, 1300, 440, 1332, 412, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 10020, 3496, 1736, 444, 432, 436, 1304, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 432, 440, 428, 444, 432, 440, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 440, 432, 444, 428, 444, 1300, 444, 428, 440, 432, 444, 428, 440, 432, 440, 432, 444, 428, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 428, 444, 1300, 444, 428, 444, 428, 444, 1300, 444, 1304, 440, 1300, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 1300, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 1304, 440, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 428, 444, 432, 440, 432, 440, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 1304, 444, 1300, 440, 1304, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 428, 444, 432, 440, 432, 440, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 428, 444, 428, 444, 428, 448, 424, 444, 428, 444, 428, 440, 1304, 444, 428, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 428, 444, 432, 440, 428, 444, 432, 440, 428, 444, 428, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 1300, 444, 428, 444, 1300, 444, 1300, 444},
  {3496, 1736, 444, 428, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 492, 380, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 440, 432, 440, 1304, 492, 380, 440, 432, 440, 432, 440, 432, 492, 380, 492, 376, 444, 432, 440, 1300, 444, 1300, 496, 1248, 444, 428, 496, 376, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 496, 376, 440, 432, 492, 380, 440, 432, 440, 428, 496, 376, 444, 428, 444, 428, 444, 432, 440, 428, 444, 428, 444, 428, 472, 400, 444, 428, 444, 428, 444, 428, 444, 428, 496, 1248, 444, 1300, 440, 432, 492, 380, 440, 432, 492, 380, 440, 432, 440, 10020, 3496, 1736, 444, 428, 444, 1300, 444, 428, 492, 380, 496, 376, 444, 428, 440, 432, 440, 432, 496, 376, 440, 432, 444, 428, 440, 432, 440, 428, 444, 1300, 444, 428, 444, 432, 440, 428, 444, 428, 444, 432, 440, 428, 444, 428, 444, 1300, 496, 1248, 444, 1300, 444, 428, 444, 428, 444, 1300, 440, 432, 440, 432, 440, 432, 492, 380, 492, 380, 492, 380, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 492, 376, 444, 428, 444, 1300, 444, 428, 444, 428, 444, 1300, 496, 1248, 496, 1248, 496, 376, 444, 428, 444, 428, 444, 428, 496, 1248, 440, 1304, 496, 376, 440, 1304, 440, 432, 440, 432, 492, 380, 440, 428, 444, 432, 440, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 492, 380, 440, 432, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 432, 492, 380, 440, 428, 444, 432, 484, 384, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 496, 1248, 496, 1248, 444, 1300, 496, 376, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 1304, 440, 1304, 440, 1304, 440, 428, 496, 376, 496, 376, 444, 428, 496, 376, 444, 428, 496, 376, 444, 428, 496, 376, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 496, 376, 440, 432, 440, 1304, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 432, 440, 432, 440, 428, 496, 380, 440, 428, 444, 428, 444, 428, 444, 428, 496, 376, 444, 428, 496, 376, 444, 428, 444, 428, 444, 428, 492, 380, 444, 428, 440, 1304, 440, 432, 492, 380, 444, 428, 440, 1304, 440, 432, 440, 1304, 440, 1304, 440},
  {3496, 1736, 444, 428, 444, 1300, 444, 428, 444, 428, 440, 432, 444, 428, 444, 428, 444, 428, 444, 424, 448, 428, 444, 424, 448, 424, 448, 424, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 424, 472, 404, 444, 424, 444, 428, 444, 428, 448, 424, 472, 400, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 1304, 440, 1300, 448, 424, 448, 424, 448, 424, 444, 428, 448, 424, 444, 10024, 3496, 1736, 468, 404, 444, 1300, 440, 432, 444, 428, 440, 432, 440, 432, 440, 428, 468, 408, 468, 400, 448, 428, 444, 424, 472, 400, 444, 428, 444, 1300, 444, 428, 448, 424, 444, 428, 444, 428, 444, 428, 448, 428, 440, 428, 444, 1300, 444, 1300, 444, 1300, 440, 432, 440, 432, 440, 1304, 444, 428, 440, 428, 448, 424, 472, 400, 448, 424, 444, 432, 440, 428, 448, 424, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 472, 1272, 444, 428, 448, 424, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 428, 444, 1300, 444, 428, 444, 1300, 440, 428, 444, 428, 448, 424, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 472, 400, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 1296, 448, 1308, 432, 428, 472, 400, 444, 428, 448, 424, 444, 428, 448, 424, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1296, 448, 1296, 444, 1300, 448, 424, 472, 400, 444, 428, 444, 428, 444, 428, 444, 428, 448, 424, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 424, 448, 424, 448, 424, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 448, 424, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 468, 404, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 1296, 448, 428, 444, 424, 444, 1300, 444, 1300, 444},
  {3496, 1736, 444, 428, 468, 1276, 440, 432, 444, 428, 444, 428, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 1300, 444, 432, 440, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 440, 1304, 444, 1300, 444, 428, 444, 428, 444, 1300, 440, 432, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 428, 444, 432, 440, 432, 440, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 444, 428, 440, 432, 444, 428, 440, 432, 440, 432, 448, 424, 444, 1300, 440, 1304, 444, 428, 440, 432, 440, 432, 448, 424, 440, 428, 444, 10024, 3496, 1736, 444, 428, 444, 1300, 440, 432, 440, 432, 444, 428, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 440, 1304, 440, 1304, 444, 428, 440, 432, 444, 1300, 444, 428, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 428, 444, 432, 440, 1304, 440, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 444, 1300, 440, 432, 468, 1276, 444, 428, 440, 432, 440, 432, 468, 404, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 468, 1272, 448, 1296, 444, 428, 444, 428, 440, 432, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 436, 436, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 428, 444, 432, 440, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 440, 432, 444, 428, 444, 428, 440, 432, 444, 428, 444, 428, 444, 428, 440, 432, 440, 432, 440, 1304, 444, 1300, 444, 1300, 440, 432, 440, 428, 444, 432, 440, 428, 444, 428, 444, 432, 436, 432, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 468, 404, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 428, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 1304, 468, 404, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 428, 444, 428, 444, 432, 440, 428, 444, 428, 444, 428, 440, 432, 440, 436, 440, 428, 444, 428, 444, 1300, 444, 428, 444, 1300, 444, 1300, 440, 432, 444, 428, 440, 1304, 440, 1304, 440},
  {3496, 1740, 440, 432, 440, 1300, 444, 432, 440, 432, 440, 428, 416, 456, 444, 428, 444, 428, 440, 432, 440, 432, 444, 428, 440, 432, 444, 428, 444, 1300, 444, 428, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 444, 428, 440, 1304, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 1300, 444, 432, 436, 432, 444, 432, 440, 428, 444, 428, 444, 428, 440, 432, 444, 428, 444, 428, 444, 428, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 416, 456, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 428, 444, 428, 440, 1304, 468, 1276, 444, 428, 444, 428, 440, 432, 440, 432, 444, 428, 440, 10024, 3492, 1740, 416, 456, 440, 1304, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 436, 432, 444, 428, 468, 404, 444, 428, 444, 432, 440, 428, 416, 456, 444, 1300, 472, 1272, 444, 1300, 440, 432, 444, 428, 416, 1328, 444, 428, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 444, 428, 444, 428, 440, 432, 444, 428, 444, 428, 440, 432, 444, 428, 440, 1300, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 1300, 444, 428, 444, 428, 444, 428, 440, 432, 444, 428, 444, 428, 468, 404, 440, 428, 444, 432, 444, 1300, 444, 1296, 444, 428, 448, 424, 444, 428, 448, 1296, 444, 1300, 444, 1300, 448, 424, 444, 428, 444, 1300, 444, 1300, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 444, 424, 444, 428, 444, 428, 444, 1300, 444, 1304, 440, 1304, 440, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 1300, 444, 1300, 440, 432, 444, 428, 440, 432, 444, 428, 440, 432, 444, 424, 472, 400, 444, 432, 444, 424, 476, 400, 440, 428, 444, 428, 472, 400, 472, 400, 448, 424, 444, 428, 472, 1272, 444, 428, 444, 428, 472, 400, 444, 428, 444, 428, 444, 428, 444, 1300, 444, 428, 440, 432, 444, 428, 444, 428, 444, 428, 444, 428, 440, 432, 444, 428, 444, 424, 444, 432, 444, 428, 444, 424, 448, 424, 448, 424, 448, 424, 444, 428, 448, 1296, 444, 1300, 444, 428, 448, 1296, 444, 428, 444, 428, 444, 1300, 444, 1300, 444}
};

const unsigned int Signals_TURN_OFF[] PROGMEM = {3548, 1688, 492, 380, 440, 1300, 444, 428, 496, 376, 444, 432, 440, 428, 444, 428, 444, 428, 496, 380, 492, 380, 440, 432, 440, 432, 440, 428, 444, 1304, 492, 380, 492, 376, 440, 432, 440, 432, 496, 376, 440, 432, 440, 432, 440, 1304, 492, 1252, 496, 1252, 436, 432, 496, 376, 440, 1304, 440, 432, 440, 432, 492, 380, 492, 380, 492, 380, 440, 432, 440, 460, 412, 432, 440, 432, 492, 380, 440, 432, 440, 432, 440, 432, 444, 428, 440, 432, 440, 432, 492, 380, 440, 432, 492, 380, 492, 380, 440, 432, 440, 432, 440, 432, 492, 380, 492, 380, 492, 380, 492, 380, 440, 432, 440, 432, 440, 432, 440, 1300, 444, 1300, 444, 432, 440, 432, 440, 432, 440, 428, 476, 400, 440, 10024, 3544, 1688, 440, 432, 440, 1304, 440, 432, 492, 380, 492, 408, 464, 384, 488, 376, 444, 456, 416, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1300, 444, 432, 492, 380, 492, 376, 444, 432, 492, 380, 492, 376, 444, 432, 440, 1300, 484, 1260, 496, 1248, 496, 376, 444, 432, 436, 1308, 436, 432, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 496, 376, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 1304, 440, 1304, 440, 1304, 492, 380, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 492, 1252, 492, 1252, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 492, 380, 492, 1252, 440, 1300, 496, 380, 492, 380, 440, 428, 444, 1304, 440, 1304, 492, 1248, 444, 432, 440, 432, 440, 1300, 496, 1248, 492, 380, 444, 428, 440, 436, 488, 380, 496, 376, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 436, 488, 1252, 440, 1304, 440, 1304, 440, 432, 492, 380, 440, 432, 496, 380, 496, 372, 492, 380, 492, 380, 440, 432, 440, 432, 492, 1252, 440, 1304, 440, 1304, 440, 432, 440, 432, 440, 432, 492, 380, 492, 380, 492, 380, 440, 432, 440, 432, 440, 432, 468, 404, 492, 380, 440, 432, 440, 432, 440, 432, 440, 432, 440, 432, 440, 1304, 440, 432, 440, 432, 440, 432, 464, 404, 496, 380, 440, 432, 492, 1252, 492, 376, 444, 428, 444, 432, 440, 432, 440, 428, 496, 376, 496, 376, 444, 432, 440, 432, 440, 432, 488, 380, 496, 380, 492, 376, 496, 376, 440, 432, 440, 432, 492, 380, 440, 436, 436, 432, 492, 1252, 444, 1300, 440, 432, 440, 1304, 440, 1304, 440};

unsigned int mode = 2; // 22 °C
unsigned int maxMode = 5; // 19 °C
float maxModeTemperature = 24;

void setup() {
  bme.begin(0x76);
  delay(100);

  Serial.begin(9600);
}

void loop() {
  float temperature = bme.readTemperature();

  Serial.println("--------");
  Serial.print("Temperature: ");
  Serial.println(temperature);
  Serial.print("Mode temperature: ");
  Serial.println(getTemperatureOfMode());

  unsigned int expectedMode = getMode();

  if (expectedMode != mode) {
    setMode(expectedMode);

  } else {
    toggleAcPower(temperature);
  }

  delay(1000);
}

void toggleAcPower(float temperature)
{
  if (temperature <= minTemperature) {
    if (AC_OFF == false) {
      turnOffAC();
      AC_OFF = true;
      AC_ON = false;
      return;
    }
  }

  if (temperature >= maxTemperature) {
    if (AC_ON == false) {
      turnOnAC(mode);
      AC_ON = true;
      AC_OFF = false;
      return;
    }
  }
}

void turnOnAC(unsigned int mode) {
  if (mode > maxMode) {
    Serial.println("ON AC: incorrect mode");
    return;
  }

  int size = sizeof(Signals_TURN_ON[mode]) / sizeof(int);
  unsigned int buffer[size];

  for (int i = 0; i < size; i++) {
    buffer[i] = pgm_read_dword(&Signals_TURN_ON[mode][i]);
  }

  irsend.sendRaw(buffer, size, khz);
  Serial.println("ON AC");
}

void turnOffAC() {
  int size = sizeof(Signals_TURN_OFF) / sizeof(int);
  unsigned int buffer[size];

  for (int i = 0; i < size; i++) {
    buffer[i] = pgm_read_dword(&Signals_TURN_OFF[i]);
  }

  irsend.sendRaw(buffer, size, khz);
  Serial.println("OFF AC");
}

unsigned int getMode()
{
  unsigned int value = analogRead(modeAnalogPin);
  unsigned int mode = map(value, 0, 1023, 0, maxMode);

  return mode;
}

void setMode(unsigned int value)
{
  mode = value;
  turnOnAC(mode);
}

unsigned int getTemperatureOfMode()
{
  return maxModeTemperature - mode;
}


